{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/blog/ts-utility/","result":{"data":{"site":{"siteMetadata":{"title":"K.Iwata's BLOG"}},"markdownRemark":{"id":"8a877340-0c24-571b-8462-ddf32285ce04","excerpt":"TypeScriptにおけるUtilityとは、 コード内で型変換を容易にする為にTypeScript…","html":"<p>TypeScriptにおけるUtilityとは、<br>\nコード内で型変換を容易にする為にTypeScriptが提供する型<br>\nです。</p>\n<p>実際、簡単に定義でき使いやすく便利なのですが、一体内部ではどのように変換されて生成しているのかが気になります。</p>\n<p>今回は、その中の型変換がどのようになされるのか、解剖していきます。<br>\n常時、更新します。。</p>\n<p>とりあえずよく使ってるものからみていきます。</p>\n<h2 id=\"partial\">Partial</h2>\n<p><code class=\"language-text\">Partial&lt;T&gt;</code><br>\n省略プロパティを生成する型です。</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">interface</span> <span class=\"token class-name\">Person</span> <span class=\"token punctuation\">{</span>\n    firstName<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n    lastName<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n    age<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">Partial<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">[</span><span class=\"token constant\">P</span> <span class=\"token keyword\">in</span> <span class=\"token keyword\">keyof</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">]</span><span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">[</span><span class=\"token constant\">P</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">OptionalPerson</span> <span class=\"token operator\">=</span> Partial<span class=\"token operator\">&lt;</span>Person<span class=\"token operator\">></span>\n\n<span class=\"token comment\">// result</span>\n<span class=\"token comment\">// type OptionalPerson = {</span>\n<span class=\"token comment\">//   firstName?: string | undefined;</span>\n<span class=\"token comment\">//   lastName?: string | undefined;</span>\n<span class=\"token comment\">//   age?: number | undefined;</span>\n<span class=\"token comment\">// }</span></code></pre></div>\n<h2 id=\"required\">Required</h2>\n<p><code class=\"language-text\">Required&lt;T&gt;</code><br>\n省略を取り除く型です。</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">interface</span> <span class=\"token class-name\">Person</span> <span class=\"token punctuation\">{</span>\n    firstName<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n    lastName<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n    age<span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token builtin\">number</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">Required<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">[</span><span class=\"token constant\">P</span> <span class=\"token keyword\">in</span> <span class=\"token keyword\">keyof</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">]</span><span class=\"token operator\">-</span><span class=\"token operator\">?</span><span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">[</span><span class=\"token constant\">P</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">OptionalPerson</span> <span class=\"token operator\">=</span> Required<span class=\"token operator\">&lt;</span>Person<span class=\"token operator\">></span>\n\n<span class=\"token comment\">// result</span>\n<span class=\"token comment\">// type OptionalPerson = {</span>\n<span class=\"token comment\">//   firstName: string;</span>\n<span class=\"token comment\">//   lastName: string;</span>\n<span class=\"token comment\">//   age: number;</span>\n<span class=\"token comment\">// }</span></code></pre></div>\n<h2 id=\"record\">Record</h2>\n<p><code class=\"language-text\">Record&lt;K, T&gt;</code><br>\nKのプロパティを持つTの型を作成できます。</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">type</span> <span class=\"token class-name\">Day</span> <span class=\"token operator\">=</span> <span class=\"token string\">'Mon'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'Tue'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'Wed'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'Thu'</span> <span class=\"token operator\">|</span> <span class=\"token string\">'Fri'</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">Todo</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    todo<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n    completed<span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">Record<span class=\"token operator\">&lt;</span><span class=\"token constant\">K</span> <span class=\"token keyword\">extends</span> <span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> <span class=\"token builtin\">number</span> <span class=\"token operator\">|</span> <span class=\"token builtin\">symbol</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">T</span><span class=\"token operator\">></span></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">[</span><span class=\"token constant\">P</span> <span class=\"token keyword\">in</span> <span class=\"token constant\">K</span><span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> <span class=\"token constant\">T</span> <span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">DayTodoProps</span> <span class=\"token operator\">=</span> Records<span class=\"token operator\">&lt;</span>Day<span class=\"token punctuation\">,</span> Todo<span class=\"token operator\">></span>\n\n<span class=\"token comment\">// result</span>\n<span class=\"token comment\">// type DayTodoProps = {</span>\n<span class=\"token comment\">//   Mon: Todo;</span>\n<span class=\"token comment\">//   Tue: Todo;</span>\n<span class=\"token comment\">//   Wed: Todo;</span>\n<span class=\"token comment\">//   Thu: Todo;</span>\n<span class=\"token comment\">//   Fri: Todo;</span>\n<span class=\"token comment\">// }</span></code></pre></div>\n<h2 id=\"pick\">Pick</h2>\n<p><code class=\"language-text\">Pick&lt;T, K&gt;</code><br>\nKに指定したプロパティを持ってきて、新しい型を生成します。</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">interface</span> <span class=\"token class-name\">Values</span> <span class=\"token punctuation\">{</span>\n    a<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n    b<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span>\n    c<span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">Pick<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">K</span> <span class=\"token keyword\">extends</span> <span class=\"token keyword\">keyof</span> <span class=\"token constant\">T</span><span class=\"token operator\">></span></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">[</span> <span class=\"token constant\">P</span> <span class=\"token keyword\">in</span> <span class=\"token constant\">K</span> <span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">[</span><span class=\"token constant\">P</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">PickValues</span> <span class=\"token operator\">=</span> Pick<span class=\"token operator\">&lt;</span>Values<span class=\"token punctuation\">,</span> <span class=\"token string\">'a'</span><span class=\"token operator\">|</span><span class=\"token string\">'c'</span><span class=\"token operator\">></span>\n\n<span class=\"token comment\">// result</span>\n<span class=\"token comment\">// type PickValues = {</span>\n<span class=\"token comment\">//   a: string;</span>\n<span class=\"token comment\">//   c: boolean;</span>\n<span class=\"token comment\">// }</span></code></pre></div>\n<h2 id=\"omit\">Omit</h2>\n<p><code class=\"language-text\">Omit&lt;T, K&gt;</code>\nPickとは逆の動きです。<br>\n<code class=\"language-text\">Kのプロパティを除く、新しい型を生成</code>します。</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">interface</span> <span class=\"token class-name\">Values</span> <span class=\"token punctuation\">{</span>\n    a<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n    b<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span>\n    c<span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">Omits<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">K</span> <span class=\"token keyword\">extends</span> <span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> <span class=\"token builtin\">number</span> <span class=\"token operator\">|</span> <span class=\"token builtin\">symbol</span><span class=\"token operator\">></span></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">[</span><span class=\"token constant\">P</span> <span class=\"token keyword\">in</span> Exclude<span class=\"token operator\">&lt;</span><span class=\"token keyword\">keyof</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">K</span><span class=\"token operator\">></span><span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">[</span><span class=\"token constant\">P</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">PickValues</span> <span class=\"token operator\">=</span> Omits<span class=\"token operator\">&lt;</span>Values<span class=\"token punctuation\">,</span> <span class=\"token string\">'a'</span><span class=\"token operator\">|</span><span class=\"token string\">'c'</span><span class=\"token operator\">></span>\n\n<span class=\"token comment\">// result</span>\n<span class=\"token comment\">// type PickValues = {</span>\n<span class=\"token comment\">//   b: number;</span>\n<span class=\"token comment\">// }</span></code></pre></div>\n<h2 id=\"exclude\">Exclude</h2>\n<p><code class=\"language-text\">Exclude&lt;T, U&gt;</code><br>\nTとUは文字列リテラル Union 型で、Tにしかない文字列リテラル (Union) 型を返します。</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">interface</span> <span class=\"token class-name\">Values</span> <span class=\"token punctuation\">{</span>\n    a<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n    b<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span>\n    c<span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">Exclude<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">U</span><span class=\"token operator\">></span></span> <span class=\"token operator\">=</span> <span class=\"token constant\">T</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\"><span class=\"token constant\">U</span></span> <span class=\"token operator\">?</span> <span class=\"token builtin\">never</span> <span class=\"token operator\">:</span> <span class=\"token constant\">T</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">ExcludesValues</span> <span class=\"token operator\">=</span> Exclude<span class=\"token operator\">&lt;</span><span class=\"token keyword\">keyof</span> Values<span class=\"token punctuation\">,</span> <span class=\"token string\">'a'</span><span class=\"token operator\">></span> \n\n<span class=\"token comment\">// result</span>\n<span class=\"token comment\">// type ExcludesValues = \"b\" | \"c\"</span></code></pre></div>\n<h2 id=\"extract\">Extract</h2>\n<p><code class=\"language-text\">Extract&lt;T&gt;</code>\n先ほどのExcludeとは逆の動きです。<br>\nTとUにある文字列リテラルを返します。</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">interface</span> <span class=\"token class-name\">Values</span> <span class=\"token punctuation\">{</span>\n    a<span class=\"token operator\">:</span> <span class=\"token builtin\">string</span>\n    b<span class=\"token operator\">:</span> <span class=\"token builtin\">number</span>\n    c<span class=\"token operator\">:</span> <span class=\"token builtin\">boolean</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">Extract<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">U</span><span class=\"token operator\">></span></span> <span class=\"token operator\">=</span> <span class=\"token constant\">T</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\"><span class=\"token constant\">U</span></span> <span class=\"token operator\">?</span> <span class=\"token constant\">T</span> <span class=\"token operator\">:</span> <span class=\"token builtin\">never</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">ExtractValues</span> <span class=\"token operator\">=</span> Extract<span class=\"token operator\">&lt;</span><span class=\"token keyword\">keyof</span> Values<span class=\"token punctuation\">,</span> <span class=\"token string\">'a'</span><span class=\"token operator\">></span> \n\n<span class=\"token comment\">// result</span>\n<span class=\"token comment\">// type ExtractValues = \"a\"</span></code></pre></div>\n<h2 id=\"nonnullable\">NonNullable</h2>\n<p><code class=\"language-text\">NonNullable&lt;T&gt;</code><br>\nnullやundefinedを取り除いてくれます。</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">type</span> <span class=\"token class-name\">NonNullables<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span></span> <span class=\"token operator\">=</span> <span class=\"token constant\">T</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\"><span class=\"token keyword\">null</span></span> <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span> <span class=\"token operator\">?</span> <span class=\"token builtin\">never</span> <span class=\"token operator\">:</span> <span class=\"token constant\">T</span>\n<span class=\"token keyword\">type</span> <span class=\"token class-name\">Result</span> <span class=\"token operator\">=</span> NonNullables<span class=\"token operator\">&lt;</span><span class=\"token string\">'iwt'</span> <span class=\"token operator\">|</span> <span class=\"token number\">10</span> <span class=\"token operator\">|</span> <span class=\"token boolean\">true</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">|</span> <span class=\"token keyword\">undefined</span><span class=\"token operator\">></span>\n\n<span class=\"token comment\">// result</span>\n<span class=\"token comment\">// type Result = true | \"iwt\" | 10</span></code></pre></div>\n<h2 id=\"感想\">感想</h2>\n<p>使うのならば、中身を知っていた方がより知見が広まると感じました。</p>","frontmatter":{"title":"TypeScriptのUtilityを解剖してみる","date":"2020-12-17","description":null,"hero":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAEDBP/EABUBAQEAAAAAAAAAAAAAAAAAAAAD/9oADAMBAAIQAxAAAAHlZryqD//EABgQAAIDAAAAAAAAAAAAAAAAAAECERIg/9oACAEBAAEFAgsiuf/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABcQAQEBAQAAAAAAAAAAAAAAAAERACD/2gAIAQEAAT8hWwmXZTJGcf/aAAwDAQACAAMAAAAQIA//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAEAAgIDAAAAAAAAAAAAAAABABEgQSFRYf/aAAgBAQABPxAptLFqoHkXx3LpI11h/9k=","aspectRatio":1.5,"src":"/static/f2cd74137daea4f2a566c8957f16435f/9842e/typescript.jpg","srcSet":"/static/f2cd74137daea4f2a566c8957f16435f/07ab6/typescript.jpg 225w,\n/static/f2cd74137daea4f2a566c8957f16435f/32fd5/typescript.jpg 450w,\n/static/f2cd74137daea4f2a566c8957f16435f/9842e/typescript.jpg 900w","srcWebp":"/static/f2cd74137daea4f2a566c8957f16435f/210c1/typescript.webp","srcSetWebp":"/static/f2cd74137daea4f2a566c8957f16435f/975bf/typescript.webp 225w,\n/static/f2cd74137daea4f2a566c8957f16435f/b8a88/typescript.webp 450w,\n/static/f2cd74137daea4f2a566c8957f16435f/210c1/typescript.webp 900w","sizes":"(max-width: 900px) 100vw, 900px"},"sizes":{"src":"/static/f2cd74137daea4f2a566c8957f16435f/14b42/typescript.jpg"}}}},"tableOfContents":"<ul>\n<li><a href=\"#partial\">Partial</a></li>\n<li><a href=\"#required\">Required</a></li>\n<li><a href=\"#record\">Record</a></li>\n<li><a href=\"#pick\">Pick</a></li>\n<li><a href=\"#omit\">Omit</a></li>\n<li><a href=\"#exclude\">Exclude</a></li>\n<li><a href=\"#extract\">Extract</a></li>\n<li><a href=\"#nonnullable\">NonNullable</a></li>\n<li><a href=\"#%E6%84%9F%E6%83%B3\">感想</a></li>\n</ul>"}},"pageContext":{"slug":"/ts-utility/","previous":{"fields":{"slug":"/typeing-game/"},"frontmatter":{"title":"仮面ライダーが好きすぎてタイピングゲーム作ったんだ","tags":["typescript","javascript"]}},"next":{"fields":{"slug":"/graphql-todo-app/"},"frontmatter":{"title":"GraphQLとReactでTODOアプリを作成する。","tags":["graphql","javascript","react"]}}}},"staticQueryHashes":["1469311817","253180232"]}